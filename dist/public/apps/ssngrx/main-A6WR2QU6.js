import{b as ve,c as be,d as Ee,e as Ie,f as ye}from"./chunk-KLACDKLO.js";import{a as xe,b as De,c as ke,d as Fe}from"./chunk-L7TOC4T7.js";import{D as Ne,E as Oe,F as Me,H as Te,I as we,a as Se,b as _e}from"./chunk-O3XRCEAU.js";import{a as de,b as ue,c as z,d as fe,e as he,f as T,g as ge,ha as Ae,ja as Ce,ma as Re}from"./chunk-KDN2CY5X.js";import{f as Pe,g as v,h as w,m as He,n as x,p as je,u as Le}from"./chunk-M7TXNM4V.js";import"./chunk-CARY4E7O.js";import{Cb as i,Db as a,Eb as V,Ec as se,Ga as C,H as _,Ic as pe,L as Y,Nb as re,Nc as le,Oa as h,Oc as me,P as X,Pc as ce,Vb as ne,Wb as s,Yb as W,Z as A,_b as oe,aa as j,ab as d,ba as G,bb as U,cb as ee,cc as u,da as c,dc as f,e as q,eb as te,fc as ie,ga as Z,gb as R,ia as p,j as H,ja as L,jb as N,mc as ae,oa as Q,q as I,qb as O,r as y,ra as K,sa as B,tb as g,u as S,zc as M}from"./chunk-DZTCXJT3.js";var J=[]=[{path:"register",loadChildren:()=>import("./chunk-463J333F.js").then(n=>n.registerRoutes)},{path:"quotes",loadChildren:()=>import("./chunk-SVUUAL66.js").then(n=>n.quotesTableRouter)},{path:"admin",loadChildren:()=>import("./chunk-GKNTFQV6.js").then(n=>n.adminRouter)}];var $e=(()=>{class n extends x{constructor(t,r,o){super(t,r,o)}ngOnDestroy(){this.flush()}static{this.\u0275fac=function(r){return new(r||n)(p(M),p(v),p(w))}}static{this.\u0275prov=c({token:n,factory:n.\u0275fac})}}return n})();function qe(){return new He}function Ye(n,e,t){return new Le(n,e,t)}var Be=[{provide:w,useFactory:qe},{provide:x,useClass:$e},{provide:R,useFactory:Ye,deps:[T,x,C]}],Xe=[{provide:v,useFactory:()=>new je},{provide:h,useValue:"BrowserAnimations"},...Be],gt=[{provide:v,useClass:Pe},{provide:h,useValue:"NoopAnimations"},...Be];function Ue(){return N("NgEagerAnimations"),[...Xe]}var Ge="@",Ze=(()=>{class n{constructor(t,r,o,l,m){this.doc=t,this.delegate=r,this.zone=o,this.animationType=l,this.moduleImpl=m,this._rendererFactoryPromise=null,this.scheduler=L(te,{optional:!0}),this.loadingSchedulerFn=L(Qe,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){let t=()=>this.moduleImpl??import("./chunk-JOLWBUX2.js").then(o=>o),r;return this.loadingSchedulerFn?r=this.loadingSchedulerFn(t):r=t(),r.catch(o=>{throw new G(5300,!1)}).then(({\u0275createEngine:o,\u0275AnimationRendererFactory:l})=>{this._engine=o(this.animationType,this.doc);let m=new l(this.delegate,this._engine,this.zone);return this.delegate=m,m})}createRenderer(t,r){let o=this.delegate.createRenderer(t,r);if(o.\u0275type===0)return o;typeof o.throwOnSyntheticProps=="boolean"&&(o.throwOnSyntheticProps=!1);let l=new $(o);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(m=>{let Je=m.createRenderer(t,r);l.use(Je),this.scheduler?.notify(10)}).catch(m=>{l.use(o)}),l}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}static{this.\u0275fac=function(r){ee()}}static{this.\u0275prov=c({token:n,factory:n.\u0275fac})}}return n})(),$=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let t of this.replay)t(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,t){this.delegate.appendChild(e,t)}insertBefore(e,t,r,o){this.delegate.insertBefore(e,t,r,o)}removeChild(e,t,r){this.delegate.removeChild(e,t,r)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,r,o){this.delegate.setAttribute(e,t,r,o)}removeAttribute(e,t,r){this.delegate.removeAttribute(e,t,r)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,r,o){this.delegate.setStyle(e,t,r,o)}removeStyle(e,t,r){this.delegate.removeStyle(e,t,r)}setProperty(e,t,r){this.shouldReplay(t)&&this.replay.push(o=>o.setProperty(e,t,r)),this.delegate.setProperty(e,t,r)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,r){return this.shouldReplay(t)&&this.replay.push(o=>o.listen(e,t,r)),this.delegate.listen(e,t,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(Ge)}},Qe=new Z("");function Ve(n="animations"){return N("NgAsyncAnimations"),K([{provide:R,useFactory:(e,t,r)=>new Ze(e,t,r,n),deps:[M,T,C]},{provide:h,useValue:n==="noop"?"NoopAnimations":"BrowserAnimations"}])}var E=new Map([["SERVICE_UNAVAILABLE",{code:0,message:"Service is unavailable",retryConnection:!0,route:"",redirect:!1,buttonName:"Okay"}],["AUTHENTICATION_FAILED",{code:401,message:`Your session is not authenticated.
 You have to Log In again`,retryConnection:!0,route:"register",redirect:!0,buttonName:"Go to login"}],["ACCESS_FORBIDEN",{code:403,message:"Access is forbidden",retryConnection:!0,route:"back",redirect:!1,buttonName:"Back"}],["INTERNAL_ERROR",{code:500,message:"Server is unavailable",retryConnection:!0,route:"",redirect:!1,buttonName:"Okay"}],["JWT_EXPIRED",{code:511,message:"Token jwt is expired",retryConnection:!0,authErr:!0,route:"register",redirect:!0,buttonName:"Go to login"}],["CLOSE_USER_CONNECTION",{code:4001,message:"Request to close the connection",retryConnection:!0,authErr:!0}]]),We=new Map([["ECONNREFUSED","Connection has been refused"]]);var D=class n{constructor(e){this.http=e;this.refreshTokenSub.pipe(X(()=>this.refreshToken())).subscribe(()=>this.refreshTokenReady.next(!0))}refreshTokenSub=new H;refreshTokenReady=new H;refreshToken(){return this.http.get(Re+"users/refresh").pipe(S(()=>!0),_(e=>(console.log("catchError refreshToken",e),y(()=>e))))}static \u0275fac=function(t){return new(t||n)(p(ue))};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};var k=class n{constructor(e,t,r,o){this.router=e;this.snacksService=t;this.location=r;this.jwtHandlerService=o}showError(e,t=""){let r=E.get(e);this.snacksService.openSnackObserve(r?.message+`
 `+t,r?.buttonName||"Ok","error-snackBar").pipe(j(()=>r?.redirect?this.router.navigate([r?.route]):null),j(()=>r?.redirect===!1&&r.route==="back"?this.location.back():null)).subscribe()}handleErrorCode(e){switch(e.status){case E.get("AUTHENTICATION_FAILED").code:this.showError("AUTHENTICATION_FAILED",e?.error);break;case E.get("ACCESS_FORBIDEN").code:this.showError("ACCESS_FORBIDEN");break;case 0:this.showError("SERVICE_UNAVAILABLE");break;default:console.log("intercept: unrecognized error code: ",e),this.snacksService.openSnack(`Module:${e.error.ml} | Code: ${We.get(e.error.msg)||e.error.msg}`,"Okay","error-snackBar");break}return e.status||0}intercept(e,t){return t.handle(e).pipe(S(r=>r),_(r=>I(r.status).pipe(A(o=>o===E.get("JWT_EXPIRED").code?(this.jwtHandlerService.refreshTokenSub.next(!0),this.jwtHandlerService.refreshTokenReady.asObservable().pipe(Y(1),A(()=>I(e)))):I(this.handleErrorCode(r))),A(o=>o instanceof de?this.intercept(e,t):y(()=>r)))))}static \u0275fac=function(t){return new(t||n)(p(be),p(we),p(se),p(D))};static \u0275prov=c({token:n,factory:n.\u0275fac})};var F=class n{intercept(e,t){return t.handle(e.clone({withCredentials:!0}))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=c({token:n,factory:n.\u0275fac})};var ze={providers:[B(ye.forRoot(J,{onSameUrlNavigation:"reload"})),B(Oe.forRoot(Ne)),Ue(),ae({eventCoalescing:!0}),Ie(J),Ve(),fe(he()),{provide:z,useClass:F,multi:!0},{provide:z,useClass:k,multi:!0}]};function tt(n,e){n&1&&(i(0,"a",10),s(1,"LogIn/SignUp"),a())}function rt(n,e){if(n&1&&(i(0,"button",11)(1,"mat-icon",12),s(2,"close"),a(),s(3),u(4,"async"),u(5,"titlecase"),i(6,"mat-icon",13),s(7,"more_vert"),a()()),n&2){let t,r=re(),o=ne(13);g("matMenuTriggerFor",o),d(3),W(" ",f(5,4,(t=f(4,2,r.user$))==null?null:t.userId)," ")}}function nt(n,e){n&1&&(i(0,"button",14)(1,"mat-icon"),s(2,"security"),a(),i(3,"span"),s(4,"Admin Panel"),a()())}var P=class n{constructor(e,t){this.authService=e;this.storageService=t;this.user$=this.authService.userDataSubject.asObservable(),this.appStorage=this.storageService.initStorageObj(1)}title="RTQ-NgRx ss";myVer=ie.full;user={userId:null,role:null};user$;appStorage;subscriptions=new q;ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnInit(){this.subscriptions.add(this.appStorage.getStorageData("jwtInfo").subscribe(e=>e?this.authService.userDataSubject.next(e.data):null))}static \u0275fac=function(t){return new(t||n)(U(Te),U(Me))};static \u0275cmp=Q({type:n,selectors:[["app-root"]],standalone:!0,features:[oe],decls:27,vars:10,consts:[["menu","matMenu"],[1,"header"],[1,"header-admin"],[1,"header__app_name"],[1,"header__app_name-mobile"],[1,"header__logging_links"],["routerLink","/register",4,"ngIf"],["class","common-action-button","mat-raised-button","",3,"matMenuTriggerFor",4,"ngIf"],["mat-menu-item","","routerLink","/admin",4,"ngIf"],["mat-menu-item","","routerLink","/register/logout/:logout"],["routerLink","/register"],["mat-raised-button","",1,"common-action-button",3,"matMenuTriggerFor"],["fontIcon","perm_identity"],["iconPositionEnd","","fontIcon","more_vert","prefix",""],["mat-menu-item","","routerLink","/admin"]],template:function(t,r){if(t&1&&(i(0,"header",1)(1,"div",2)(2,"p",3),s(3),a(),i(4,"p",4),s(5,"real-time quotes"),V(6,"br"),a()(),i(7,"div",5),O(8,tt,2,0,"a",6),u(9,"async"),O(10,rt,8,6,"button",7),u(11,"async"),a()(),i(12,"mat-menu",null,0),O(14,nt,5,0,"button",8),u(15,"async"),i(16,"button",9)(17,"mat-icon"),s(18,"logout"),a(),i(19,"span"),s(20,"Log Out"),a()(),i(21,"button",9)(22,"mat-icon"),s(23,"login"),a(),i(24,"span"),s(25,"LogIn/SignUp"),a()()(),V(26,"router-outlet")),t&2){let o,l,m;d(3),W("real-time quotes dashboard angular ver ",r.myVer,""),d(5),g("ngIf",((o=f(9,4,r.user$))==null?null:o.userId)==="logout"||""),d(2),g("ngIf",((l=f(11,6,r.user$))==null?null:l.userId)!=="logout"||""),d(4),g("ngIf",((m=f(15,8,r.user$))==null?null:m.role)==="admin")}},dependencies:[ve,Ee,_e,Se,ce,pe,le,me,Ce,Ae,Fe,De,xe,ke],styles:[".visually-hidden[_ngcontent-%COMP%]{position:absolute!important;width:1px!important;height:1px!important;margin:-1px!important;border:0!important;padding:0!important;white-space:nowrap!important;clip-path:inset(100%)!important;clip:rect(0 0 0 0)!important;overflow:hidden!important}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding-right:1%;padding-left:1%}.header__app_name[_ngcontent-%COMP%]{margin:0;color:#f0f8ff}@media (max-width: 767px){.header__app_name[_ngcontent-%COMP%]{display:none}}.header__app_name-mobile[_ngcontent-%COMP%]{color:#f0f8ff;display:none}@media (max-width: 767px){.header__app_name-mobile[_ngcontent-%COMP%]{display:unset}}.header__logging_links[_ngcontent-%COMP%]{color:#f0f8ff;display:flex;gap:1vw}.header__logging_links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-top:1.5%}.header[_ngcontent-%COMP%]   .common-action-button[_ngcontent-%COMP%]{margin-top:.5vh;min-height:4vh;font-size:medium!important}@media (max-width: 767px){.header[_ngcontent-%COMP%]   .common-action-button[_ngcontent-%COMP%]{min-height:unset;font-size:smaller!important;margin-left:1%;margin-bottom:.5vh;padding-left:10%;padding-right:10%;min-width:30vw}}"]})};ge(P,ze).catch(n=>console.error(n));
